# 호이스팅
- `hoist` 라는 단어의 사전적 정의는 끌어올리기 라는 뜻이다.<br/>
- 호이스팅은 코드가 실행하기 전 변수선언/함수선언이 해당 스코프의 최상단으로 끌어 올려진 것 같은 현상을 말한다.
- 선언문은 항시 자바스크립트 엔진 구동시 가장 최우선으로 해석하므로 호이스팅 되고, **할당 구문은 런타임 과정에서 이루어지기 때문에** 호이스팅 되지 않는다.
- 자바스크립트 엔진은 코드를 실행하기 전 **실행 컨텍스트**를 위한과정에서 모든 선언(var, let, const, function, class)을 스코프에 등록한다.

**즉 자바스크립트 실행 컨텍스트에 의해 선언이 코드 실행 보다 먼저 메모리에 저장되는 과정으로 인한 현상**

## 변수 호이스팅
- 자바스크립으 모든 선언에는 호이스팅이 일어난다.
- var 키워드로 선언된 변수와는 달리 let 키워드로 선언된 변수를 선언문 이전에 참조하면 참조 에러(ReferenceError)가 발생하여 호이스팅이 발생하지 않는 것 처럼 동작한다.
- 이는 let 키워드로 선언된 변수는 스코프의 시작에서 변수의 선언까지 *일시적 사각지대(Temporal Dead Zone; TDZ)에 빠지기 때문이다.
- var 키워드는 선언과 함께 undefined로 초기화되어 메모리에 저장되는데 let과 const는 초기화되지 않은 상태로 선언만 메모리에 저장되기 때문이다.
- 초기화 되지 않으면 변수를 참조할 수 없다. 그래서 참조 에러를 일으키는 것이다.
- 아래의 에시에서 선언이 호이스팅되었기 대문에 블록 스코프에서 foo를 찾을 수 에러가 발생한것을 확인할 수 있다.

```
let foo = 1;
{
  console.log(foo);
  let foo = 2;
}
```

## 변수는 어떻게 생성되며, 호이스팅은 어떻게 이뤄질까?
변수는 3단계에 걸쳐 생성된다.

1. 선연단계
  - 변수를 실행 컨텍스트의 변수 객체에 등록한다.
  - 이 변수 객체는 스코프가 참조하는 대상이 된다.
2. 초기화 단계
  - 변수 객체에 등록된 변수를 위한 공간을 메모리에 확보한다.
  - 이 단계에서 변수는 undefined로 초기화 된다. (var의 경우 선언과 초기화가 한번에, let은 변수 선언문에 도달했을때 이뤄진다.)
3. 할당 단게
  - undefined로 초기화된 변수에 실제 값을 할당한다.

## 호이스팅 예시
- 변수 선언에서의 호이스팅
  
  ```
  // 호이스팅 때문에 선언이 끌어올려져서 오류 안남.
  console.log(text); // (선언 + 초기화 된 상태) //undefined
  text = 'Hello!'; // (선언 + 초기화 + 할당 된 상태)
  var text;
  console.log(text); //Hello!
  ```
  
  ```
  // 호이스팅 때문에 선언이 끌어올려졌지만 초기화 안된 상태에서 참조해서 오류 남.
  console.log(text); // (선언 된 상태, 초기화(메모리 공간 확보와 undefined로 초기화) 안되서 참조 불가능 -> 에러남)
  let text; // 여기서 초기화 단계가 실행됨
  ```
  
  ```
  const text; // 에러남. 주의! 애초에 const 키워드로 재할당 불가능! 그래서 선언과 동시에 할당해야함
  ```
  
  ```
  text = 'Hello'; //초기화 전 할당하기에 오류
  let text; //여기서 초기화 됨
  console.log(text)
  ```
 
- 함수 선언에서의 호이스팅
  ```
  foo1(); // 함수 선언문에서는 호이스팅 일어난다.
  foo2(); // 함수 표현식이라서 호이스팅 안된다.
  function foo1() {
    console.log('Hello');
  }
  var foo2 = function() {
    console.log('world');
  }
  ```

## 참고
https://github.com/JaeYeopHan/Interview_Question_for_Beginner/tree/master/JavaScript#hoisting
https://hanamon.kr/javascript-%ED%98%B8%EC%9D%B4%EC%8A%A4%ED%8C%85%EC%9D%B4%EB%9E%80-hoisting/ <br/>
